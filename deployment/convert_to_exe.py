
import os


def image_to_exe(input_image):
    # Read the image file
    with open(input_image, 'rb') as image_file:
        image_data = image_file.read()

    # Define the name for the output executable file
    output_exe = os.path.splitext(input_image)[0] + '.exe'

    # Write the image data to the output executable file
    with open(output_exe, 'wb') as exe_file:
        # Write a header indicating that this is an image executable
        exe_file.write(b'IMAGEEXE')

        # Write the size of the image data as a 4-byte integer
        exe_file.write(len(image_data).to_bytes(4, byteorder='little'))

        # Write the image data
        exe_file.write(image_data)

    print(f"Image converted to executable: {output_exe}")
    return output_exe


# Example usage:
input_image = "./uploads/trojan_test_alueron_genj.png"
output_exe = image_to_exe(input_image)
print("Output executable:", output_exe)