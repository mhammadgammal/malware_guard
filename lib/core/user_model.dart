import 'dart:async';

import 'package:cloud_firestore/cloud_firestore.dart';
import 'package:get_it/get_it.dart';
import 'package:malware_guard/features/history/data/history_model.dart';

class UserModel extends Disposable{
  UserModel(
      {required this.uid,
      required this.displayName,
      required this.email,
      required this.photoUrl,
      required this.history}) {
    print('User Model created');
  }

  String uid;
  String displayName;
  String email;
  String? photoUrl;
  List<HistoryModel> history;

  void fromJson(Map<String, dynamic> json, String uid, List<QueryDocumentSnapshot<Map<String, dynamic>>> docs,) {
    uid = uid;
    displayName = json['displayName'];
    email = json['email'];
    photoUrl = json['photoUrl'];
    history = List.generate(docs.length, (index) => HistoryModel.fromJson(docs[index].data()));
  }

  Map<String, dynamic> toJson() => {
        "displayName": displayName,
        "email": email,
        "photoUrl": photoUrl,
        "history":
            List.generate(history.length, (index) => history[index].toJson())
      };
  
  @override
  FutureOr onDispose() {
    print('User Model disposed');
  }

}
